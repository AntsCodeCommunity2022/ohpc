\subsection{RPM Rebuild}  \label{appendix:rpmbuild}

Users of OpenHPC may find it necessary to rebuild one of the packages to satisfy
local requirements. A simple way to accomplish this is to install the provided
source RPM, modify the specfile, and rebuild the binary RPM. A brief example
follows.

\begin{lstlisting}[language=bash,keywords={},basicstyle=\fontencoding{T1}\footnotesize\ttfamily,
    literate={VER}{\OHPCVersion{}}1 {OSREPO}{\OSRepo{}}1 {-}{-}1]
# Install rpm-build package from base OS distro
[test@sms ~]$ (*\install*) rpm-build

# Download SRPM from OpenHPC repository and install locally
[test@sms ~]$ wget \
  http://build.openhpc.community/OpenHPC:/VER:/Factory/OSREPO/src/fftw-gnu-openmpi-ohpc-3.3.4-4.1.src.rpm
[test@sms ~]$ rpm -i fftw-gnu-openmpi-ohpc-3.3.4-4.1.src.rpm

# Modify spec file as desired
[test@sms ~]$ cd ~/rpmbuild/SPECS
[test@sms ~rpmbuild/SPECS]$ perl -pi -e "s/enable-static=no/enable-static=yes/" fftw.spec

# Rebuild binary RPM. Note that additional directives can be specified to modify build
[test@sms ~rpmbuild/SPECS]$ rpmbuild -bb --define "compiler_family intel" fftw.spec

# As privileged user, install the new package
[sms](*\#*) (*\install*) ~test/rpmbuild/RPMS/x86_64/fftw-intel-openmpi-ohpc-3.3.4-4.1.rpm
\end{lstlisting}
