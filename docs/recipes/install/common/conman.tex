\conman{} is a serial console management program designed to support a large
number of console devices and simultaneous users. It supports logging console
device output to file, and connecting to compute node consoles via IPMI
serial-over-lan.

% begin_ohpc_run
% ohpc_validation_newline
% ohpc_validation_comment Optionally, define diskless node kernel arguments to support SOL console
% ohpc_command if [[ ${enable_ipmisol} -eq 1 ]];then
% ohpc_indent 5
\begin{lstlisting}[language=bash,keywords={},upquote=true]
# Install conman to provide a front-end to compute consoles and log output
[sms](*\#*) (*\install*) conman-ohpc

# Note your IPMI password is required for console access
[sms](*\#*) for ((i=0; i<$num_computes; i++)) ; do
              echo -n 'CONSOLE name="'${c_name[$i]}'" dev="ipmi:'${c_bmc[$i]}'" '
              echo 'ipmiopts="'U:${bmc_username},P:${IPMI_PASSWORD:-undefined},W:solpayloadsize'"'
           done >> /etc/conman.conf

# Enable and start conman
[sms](*\#*) systemctl enable conman
[sms](*\#*) systemctl start conman

# Define node kernel arguments to support SOL console
[sms](*\#*) wwsh -y provision set "${compute_regex}" --kargs "${kargs} console=ttyS1,115200"
\end{lstlisting}
% ohpc_indent 0
% ohpc_command fi
% end_ohpc_run

